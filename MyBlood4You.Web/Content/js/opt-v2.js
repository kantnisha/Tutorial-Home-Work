(function(){if(window._opt&&window._opt.isOptifyApi){return}var x=window.serviceUrlOverride||"service.optify.net";var f=window.location.protocol+"//"+x;var h=window.pageServerUrlOverride||"pages.optify.net";var L=f+"/v2/visit";var H=f+"/form/submit";var v=f+"/v2/form";var G;var I;var K;var e="";var t="";var r="";var D=30;var P;var l=document.referrer||"";var C=document.title;var A=document.location.href;var s=0;var u={isOptifyApi:true,push:function(){for(var T=0;T<arguments.length;T++){var U=arguments[T];if(!U[0]){B("Ignoring non-array or empty array directive");continue}var S=U[0];if(this[S]){this[S].apply(this,U.slice(1))}else{B('Ignoring unrecognized method "'+S+'"')}}},view:function(ad){if(!arguments.length){B("Call to view requires one argument");return}if(arguments.length>1){B("Too many arguments in call to view");return}switch(typeof ad){case"string":ad={site:ad};break;case"object":case"undefined":if(!ad){B("Missing Optify options in call to view");return}break;default:B("Invalid parameter type in call to view");return}var X=this.tokens(ad);if(!X){return}var W="&ref="+encodeURIComponent(Q(l));var ac="&title="+encodeURIComponent(C);var ab="&visitorId="+X.vi;var V="&url="+encodeURIComponent(Q(A));var Z="?cId="+X.site;var aa={};E();for(var U in P){var Y;if(U.substring(0,5)=="_opt_"){Y=U.substring(5)}else{if(U.substring(0,6)=="optify"){Y=U.substring(7)}else{continue}}aa[Y]=P[U]}var T=ad.properties;if(T){for(Y in T){aa[Y]=T[Y]}}var S=L+Z+ab+W+ac+V+"&"+Math.random();for(Y in aa){S+="&_opt_"+Y+"="+aa[Y]}S+="&visitId="+X.vt;c(S,O);if(ad.links){this.links(ad.links)}if(ad.forms!==false){this.forms()}},visitor:function(T){if(!arguments.length){B("Call to visitor requires one argument");return}if(arguments.length>1){B("Too many arguments in call to visitor");return}var X=this.tokens(T);var W={_opt_vid:I,_opt_visit:K,_opt_cid:G,_opt_url:A,_opt_paget:C};var S;for(var V in W){if(S){S+="&"+V+"="+encodeURIComponent(W[V])}else{S=H+"?"}}var U=T.properties;if(U){for(V in U){S+="&"+encodeURIComponent(V)+"="+encodeURIComponent(U[V])}}c(S)},forms:function(){if(!G&&!this.tokens()){B("No site configured for instrumentation of forms");return}var S=document.getElementsByTagName("form");for(var T=0;T<S.length;T++){this.form(S[T])}},form:function(V){if(!G&&!this.tokens()){B("No site configured for form instrumentation");return}V=y(V);if(!V){B("Missing form ID or element in form submit watching");return}var S=false;var U=false;var T=V.getAttribute("optify_submit");var W=V.getAttribute("optify_modify");if(J(V)){S=true;U=true}else{if(T&&T.toLowerCase()==="true"){S=true;U=true}else{if(W&&W.toLowerCase()==="true"){S=true;U=false}}}if(S){this.instrument(V)}if(U){V.action=H}},watch:function(V){if(!G&&!this.tokens()){B("No site configured for form instrumentation");return}V=y(V);if(!V){B("Missing form ID or element in form submit watching");return}var W=this.instrument(V);if(W){var Y=null;var X=function(Z){if(Z.target){Y=Z.target}else{if(Z.srcElement){Y=Z.srcElement}}};for(var U=0;U<V.elements.length;U++){var T=V.elements[U];if(T.type.toLowerCase()==="submit"){if(T.addEventListener){T.addEventListener("click",X,false)}else{if(T.attachEvent){T.attachEvent("onclick",X)}}}}var S=V.onsubmit;V.onsubmit=function(){if(S){var Z=S();if(typeof Z!=="undefined"&&!Z){return false}}var ab=u.submit(V);if(Y){var aa=document.createElement("input");aa.type="hidden";aa.name=Y.name;aa.value=Y.value;V.appendChild(aa)}w(V,ab,0);return false}}},modifyFormParameters:function(S){return S},instrument:function(U){U=y(U);if(!U){B("Missing form ID or element in form instrumentation");return false}if(U.elements._opt_cid){return false}this.hiddenField(U,"_orig_action",U.getAttribute("action")||window.location.href);this.hiddenField(U,"_opt_vid",I);this.hiddenField(U,"_opt_visit",K);this.hiddenField(U,"_opt_cid",G);this.hiddenField(U,"_opt_url",A);this.hiddenField(U,"_opt_paget",C);if(J(U)){for(var S=0;S<U.elements.length;S++){var T=U.elements[S];var V=T.className;if(V&&V==="optify_vid"){T.value=I;break}}}return true},submit:function(V){V=y(V);if(!V){B("Missing form ID or element in form submission");return""}try{var ac={};for(var X=0;X<V.elements.length;X++){var Y=V.elements[X];if(!Y.disabled&&Y.name&&Y.name.length>0){var Z=q(Y);if(Z!=""){ac[Y.name]=Z}}}ac=u.modifyFormParameters(ac);var S=[];for(key in ac){S.push(key+"="+encodeURIComponent(ac[key]))}var T=v+"?"+S.join("&")+"&r="+Math.random();var ab=new Image(1,1);ab.src=T;var W=document.createElement("img");var U="opt-form-tracker-"+s++;W.width=1;W.height=1;W.style.display="none";W.id=U;W.src=ab.src;V.appendChild(W);return U}catch(aa){B(aa)}return""},tokens:function(T){if(!T){T={}}var S=T.site||G;if(!S){B("No site token provided");return}G=S;n(T.site);z(e);E();if(T.vi!==false){var V=T.vi||I||P._opt_vi||g(e)}if(!V||V==="null"){V=j()}I=V;k();var U=T.vt||P._opt_vt||K;if(!U){if(g(t)&&U!==false){U=g(r);var W=true}if(!U){U=M(10,16)}}K=U;if(!W){m()}a(K);return{site:G,vi:I,vt:K}},links:function(S){if(!G&&!this.tokens()){B("No site configured for instrumentation of links");return}if(typeof S=="boolean"){if(S==false){return}S=undefined}var T=document.getElementsByTagName("a");if(typeof S=="string"){try{S=new RegExp(S,"i")}catch(W){B("Invalid link match regular expression: "+W);return}}if(S&&typeof S=="object"){var V=S;S=function(X){if(X.href){return X.href.match(V)}}}for(var U=0;U<T.length;U++){if(T[U].href&&(!S||S(T[U]))){this.link(T[U])}}},link:function(T){if(!G&&!this.tokens()){B("No site configured for link instrumentation");return}if(typeof T=="string"){T=document.getElementById(link)}if(!T){B("Link instrumentation missing link");return}if(!T.href){return}var S=T.href;if(S.indexOf("?")==-1){S+="?"}else{S+="&"}S+="_opt_vi="+I+"&_opt_vt="+K;T.href=S},writeVisitData:function(){var V=document.getElementsByTagName("iframe");for(var S=0;S<V.length;++S){var U=V[S];if(U.src.indexOf(h)!=-1){var W=U.src.indexOf("#");if(W!=-1){var T=U.src.substring(0,W)+"#_opt_vi="+I+"&_opt_vt="+K;U.src=T}else{U.src=U.src+"#_opt_vi="+I+"&_opt_vt="+K}}}},title:function(S){C=S},url:function(S){A=S},referrer:function(S){l=S},hiddenField:function(V,S,W){V=y(V);if(!V){B("Missing form ID or element in hiddenField");return false}var T=null;var U="input";try{T=document.createElement("<"+U+' name="'+S+'" type="hidden"/>')}catch(X){}if(!T||T.nodeName!=U.toUpperCase()){T=document.createElement(U);T.type="hidden";T.name=S}T.value=W;V.appendChild(T)}};function q(S){switch(S.nodeName.toUpperCase()){case"INPUT":switch(S.type.toLowerCase()){case"checkbox":case"radio":if(S.checked){return S.value}break;case"text":case"hidden":case"submit":case"button":case"image":return S.value;break}break;case"TEXTAREA":return S.value;break;case"SELECT":if(S.type.toLowerCase()!=="select-multiple"){return S.value}break}return""}function y(S){if(!S){return null}if(typeof S=="string"){var T=S;S=document.getElementById(T);if(!S){B("Form ID "+S+" not found");return}}return S}function n(S){e="_opt_vi_"+S;t="_opt_vs_"+S;r="_opt_vt_"+S}function w(U,T,S){if(F(T)||S>40){if(typeof U.submit==="function"){U.submit()}else{document.createElement("form").submit.call(U)}}else{window.setTimeout(function(){w(U,T,S+1)},50)}}function c(U,T){onError=T||function(){};var V=document.createElement("script");V.onerror=onError;V.type="text/javascript";V.async=true;V.src=U;var S=document.getElementsByTagName("script")[0];S.parentNode.insertBefore(V,S)}function F(S){var T=document.getElementById(S);return(T&&T.complete)}function z(Y){var S=g(Y);if(S){return}var Z="_opt_vi";var X="_opt_vs";var W="_opt_vt";var V=g(W);var U=g(Z);if(U){I=U;k()}if(V){K=V;m();a(K)}var T=new Date(2000,1,1);p(Z,U,T.toGMTString());p(X,V,T.toGMTString());p(W,V,T.toGMTString())}function j(){return M()}function p(T,V,S,W){var U=N();document.cookie=T+"="+V+((S)?";expires="+S:"")+((W)?";path="+W:";path=/")+((U)?";domain=."+U:"")}function k(){var S=new Date(2020,1,1);p(e,encodeURIComponent(I),S.toGMTString())}function m(){p(t,encodeURIComponent(I))}function a(T){var S=new Date();S.setMinutes(S.getMinutes()+D);p(r,encodeURIComponent(T),S.toGMTString())}function g(U){var T=document.cookie;var W=U+"=";var V=T.indexOf("; "+W);if(V==-1){V=T.indexOf(W);if(V!==0){return null}}else{V+=2}var S=T.indexOf(";",V);if(S==-1){S=T.length}return decodeURIComponent(T.substring(V+W.length,S))}function N(){var S=";aero;arpa;biz;cat;co;coop;com;edu;gov;info;int;jobs;mil;mobi;museum;name;net;org;pro;travel;";var V=document.domain;var T=V.split(".");if((/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/).test(V)){return V}else{if(T.length==1){return null}else{var X="";var U=0;while(U<2){U++;var W=T[T.length-U];X=W+(U>1?".":"")+X;if(S.indexOf(";"+W+";")!=-1){X=T[T.length-U-1]+"."+X;break}}return X}}}function O(){var V=document.getElementsByTagName("form");for(var T=0;T<V.length;T++){var S=V[T];var U=S.elements._orig_action;if(U&&U.value){S.action=U.value}}}function J(T){var S=false;if(T){var U=T.getAttribute("action")||window.location.href;if(U.match(/salesforce.com.*?WebToLead/i)){S=true}else{if(T.elements&&T.elements._opt_salesforce&&T.elements._opt_salesforce.value==="true"){S=true}}}return S}var B=function(S){if(window.console&&window.console.error){window.console.error("[Optify] "+S)}};var E=function(){if(P){return}P={};var U=window.location.search.substring(1).split("&");for(var S=0;S<U.length;S++){var T=U[S];var V=T.indexOf("=");if(V!=-1&&V!=T.length-1){P[T.substring(0,V)]=T.substring(V+1)}}b()};var b=function(){var U=window.location.hash.substring(1).split("&");for(var S=0;S<U.length;S++){var T=U[S];var V=T.indexOf("=");if(V!=-1&&V!=T.length-1){P[T.substring(0,V)]=T.substring(V+1)}}};var R=0;var o=function(T,S){setTimeout(function(){++R;if(window.location.hash=="#syncVisit"&&R<30){o(T,S)}else{window._opt_wait=false;T.apply(u,S)}},1000)};var Q=function(S){return S.replace(/&_opt_[^&]*/g,"").replace(/\?_opt_[^&]*$/,"").replace(/\?_opt_[^&]*&/,"?")};var d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split("");function M(S,X){var W=[],V=Math.random;X=X||d.length;if(S){for(var T=0;T<S;T++){W[T]=d[0|V()*X]}}else{var Y;W[8]=W[13]=W[18]=W[23]="-";W[14]="4";for(var U=0;U<36;U++){if(!W[U]){Y=0|V()*16;W[U]=d[(U==19)?(Y&3)|8:Y&15]}}}return W.join("")}if(window._opt&&window._opt.length){var i=window._opt}window._opt=u;if(i){i.push(["writeVisitData"]);if(window._opt_wait){o(u.push,i)}else{u.push.apply(u,i)}}})();